<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local Explorer</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta name="theme-color" content="#f8f7f2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;900&family=Raleway:wght@400;500;600&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600&family=Rye&family=Merriweather:wght@400;700&family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
  <!-- Decade-specific fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Righteous&family=Bungee&family=Monoton&family=Fascinate&family=Bebas+Neue&family=Orbitron:wght@400;700;900&family=Audiowide&family=Roboto:wght@400;500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/theme.css">
  <link rel="stylesheet" href="css/main.css">
  <script src="key.js"></script>
</head>
<body>
  <header id="appHeader">
    <h1 id="appTitle">Local Explorer</h1>
    <button id="settingsBtn" type="button" aria-label="Open settings">‚öôÔ∏è</button>
  </header>
  <main class="appShell">
    <div id="locationDisplay">Determining your location‚Ä¶</div>
    <div id="manualInputContainer">
      <input type="text" id="manualInput" placeholder="Enter a location">
    </div>
    <div id="localAlertsWidget" style="display:none;">
      <div class="alert-header">
        <span class="alert-icon">‚ö†Ô∏è</span>
        <span class="alert-title">Local Alerts</span>
        <button id="refreshAlertsBtn" type="button" aria-label="Refresh alerts">‚Üª</button>
      </div>
      <div id="alertsContent" class="alerts-list"></div>
    </div>
    <div id="primaryActions">
      <button id="myListBtn">üìã My List</button>
      <button id="myPlanBtn">üó∫Ô∏è My Plan</button>
      <button id="compassBtn">üß≠ Compass</button>
    </div>
    <div id="weatherWidget" aria-live="polite">
    <div id="weatherHeader">
      <div id="weatherLabels">
        <span id="weatherTitle">Local Weather</span>
        <span id="weatherUpdated">Waiting for location...</span>
      </div>
      <button id="refreshWeatherBtn" type="button" aria-label="Refresh weather">‚Üª</button>
      <button id="forecastBtn" type="button" aria-label="View weekly forecast" title="Weekly forecast">üìÖ</button>
      <button id="toggleWeatherBtn" type="button" aria-label="Toggle weather details" class="weather-toggle-btn">‚öì</button>
    </div>
    <div id="weatherContent">
      <div id="weatherPrimary">
        <span id="weatherIcon">--</span>
        <span id="weatherTemp">--¬∞</span>
      </div>
      <div id="weatherDetails">
        <div id="weatherDescription">We will pull the forecast once we know where you are.</div>
        <div id="weatherMeta">
          <span id="weatherFeels">Feels like --¬∞</span>
          <span id="weatherWind">Wind -- mph</span>
        </div>
        <div id="weatherRange">High --¬∞ / Low --¬∞</div>
        <div id="weatherSunInfo" style="display:none;">
          <div id="sunCountdown">--</div>
          <div id="sunMessage">--</div>
        </div>
        <div id="historicalWeatherFacts" style="display:none; margin-top:0.5rem; padding:0.5rem; background:rgba(200,121,65,0.15); border-radius:8px; font-size:0.85rem;"></div>
      </div>
    </div>
    </div>
    <div class="filters" id="filterGrid"></div>
    <div class="support-cta">
      <h3>Support the App</h3>
      <p>Enjoying these adventures? Help keep Local Explorer sailing.</p>
      <button id="donateBtn" type="button">‚ù§Ô∏è Donate</button>
    </div>
  </main>
  <div id="settingsPanel" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Settings</h3>
        <button class="close-btn" id="closeSettingsBtn">x</button>
      </div>
      <div class="setting-group">
        <label for="themeSelect">Theme</label>
        <select id="themeSelect">
          <option value="naval">Polished Sailor</option>
          <option value="sunset">Sunset Cruise</option>
          <option value="neon">Neon City Lights</option>
          <option value="arctic">Arctic Dawn</option>
          <option value="highseas">High Seas Neon</option>
          <option value="aurora">Aurora Mist</option>
          <option value="arcane">Arcane Nightfall</option>
          <option value="solstice">Solstice Glow</option>
          <option value="evergreen">Evergreen Trails</option>
          <option value="voyager">Celestial Voyager</option>
          <option value="monochrome">Monochrome Focus</option>
          <option value="playful">Playful Pop</option>
          <option value="retro90">Retro Arcade 90s</option>
          <option value="groove70">Sunburst 70s</option>
          <option value="mojave">Mojave Drift</option>
          <option value="atomic50">Atomic Age 50s</option>
          <option value="psychedelic60">Psychedelic 60s</option>
          <option value="arcade80">Arcade 80s</option>
          <option value="y2k00">Y2K 2000s</option>
          <option value="metro10">Metro 2010s</option>
          <option value="sushi">Sushi Bar</option>
          <option value="bbq">BBQ Pit</option>
          <option value="cafe">Coffee Caf√©</option>
        </select>
        <span class="setting-hint">Pick a style and we will remember it for next time.</span>
      </div>
      <div class="setting-group">
        <label for="voiceSelect">Voice</label>
        <select id="voiceSelect"></select>
        <span class="setting-hint">Used for spoken navigation prompts.</span>
      </div>
      <div class="setting-group">
        <label class="setting-toggle">
          <input type="checkbox" id="ambientModeToggle">
          <span>Ambient harbor sound cues</span>
        </label>
        <span class="setting-hint">Adds soft ambience while navigating (experimental).</span>
      </div>
      <div class="setting-group">
        <label class="setting-toggle">
          <input type="checkbox" id="birdFactsToggle" checked>
          <span>üê¶ Bird sightings</span>
        </label>
        <span class="setting-hint">Show recent bird sightings in your area.</span>
      </div>
      <div class="setting-group">
        <button id="resetSettingsBtn" class="settings-secondary" type="button">Reset to defaults</button>
      </div>
    </div>
  </div>
  <div id="forecastModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Weekly Forecast</h3>
        <button class="close-btn" id="closeForecastBtn">√ó</button>
      </div>
      <div id="forecastContent" class="forecast-grid"></div>
    </div>
  </div>
  <div id="hiddenMap"></div> <div id="subMenuModal" class="modal"><div class="modal-content"><div class="modal-header"><h3 id="subMenuTitle">Categories</h3><button class="close-btn" id="closeSubMenu">√ó</button></div><div class="subMenuList" id="subMenuList"></div></div></div>
  <div id="resultsModal" class="modal"><div class="modal-content"><div class="modal-header"><h3 id="resultsTitle">Results</h3><button class="close-btn" id="closeResults">√ó</button></div><div class="results-list" id="resultsList"></div><button id="loadMoreResultsBtn" class="load-more-btn" type="button">Keep scanning</button></div></div>
  <div id="myListModal" class="modal"><div class="modal-content"><div class="modal-header"><h3>My List</h3><button class="close-btn" id="closeMyList">√ó</button></div><div class="results-list" id="myListContent"></div><div class="empty-state" id="myListEmpty" style="display:none;">Your saved places will appear here.</div></div></div>
  <div id="planModal" class="modal"><div class="modal-content"><div class="modal-header"><h3>My Plan</h3><button class="close-btn" id="closePlan">√ó</button></div><div id="planSummary" style="margin-bottom:0.5rem; font-size:0.85rem; color:var(--card);"></div><div class="results-list" id="planContent"></div><div class="empty-state" id="planEmpty" style="display:none;">Your plan is empty.</div><div style="margin-top:0.5rem; display:flex; gap:0.5rem;"><button id="sharePlanBtn" style="flex:1; border:none; border-radius:var(--radius); background-color:var(--primary); color:var(--text-light); padding:0.5rem; font-size:0.9rem;">Share Plan</button></div></div></div>
  <div id="donateModal" class="modal"><div class="modal-content"><div class="modal-header"><h3>Support Local Explorer</h3><button class="close-btn" id="closeDonate">√ó</button></div><p style="color: var(--card); font-size: 0.9rem; margin-bottom: 1rem;">If you enjoy using Local Explorer, consider supporting development. Donations help keep this sailor‚Äôs app afloat!</p><p style="color: var(--card); font-size: 0.9rem; margin-bottom: 1rem; text-align:center;">Venmo: <strong>@Stephen-Mohamed-1</strong></p><div style="display:flex; gap:0.5rem;"><button id="openVenmoBtn" style="flex:1; border:none; border-radius:var(--radius); background-color:var(--primary); color:var(--text-light); padding:0.5rem; font-size:0.9rem;">Open Venmo</button><button id="copyVenmoBtn" style="flex:1; border:none; border-radius:var(--radius); background-color:var(--secondary); color:var(--text-light); padding:0.5rem; font-size:0.9rem;">Copy Handle</button></div></div></div>

  <div id="errorToast" class="error-toast" style="display:none;"></div>

  <div id="detailsSheet">
    <div id="detailsMap">
      </div>
    <div id="detailsContent">
      <div class="sheet-handle" aria-hidden="true"></div>
      <button id="closeDetailsBtn" class="sheet-close">√ó</button>
      
      <button id="activateStreetViewBtn" type="button" aria-label="Enable Street View Peek">üëÅÔ∏è Street View</button>
      
      <h3 id="detailsName"></h3>
      <div id="detailsRating"></div>
      <div id="detailsPhone"></div>
      <div id="detailsAddress"></div>
      <div id="detailsWhat3Words" style="display:none; margin-top:0.5rem; padding:0.5rem; background:rgba(255,255,255,0.1); border-radius:8px; font-size:0.85rem;">
        <span style="opacity:0.8;">üìç</span> <span id="detailsWhat3WordsText">Loading...</span>
      </div>
      <div id="detailsPrice"></div>
      <div id="detailsActions" class="action-grid">
        <div class="action-row primary">
          <button id="guideBtn" class="action-pill primary">üß≠ Guide Me</button>
          <button id="mapsBtn" class="action-pill outline">üìç Open in Maps</button>
        </div>
        <div class="action-row secondary">
          <button id="saveBtn" class="action-pill ghost">‚òÜ Save</button>
          <button id="planBtn" class="action-pill ghost">üó∫Ô∏è Add to Plan</button>
          <button id="shareBtn" class="action-pill ghost">üì§ Share</button>
          <button id="websiteBtn" class="action-pill ghost">üîó Website</button>
        </div>
      </div>
      <button class="accordion" id="reviewsAccordion">Reviews</button>
      <div class="accordion-content" id="reviewsContent"></div>
      <button class="accordion" id="hoursAccordion">Weekly Hours</button>
      <div class="accordion-content" id="hoursContent"></div>
    </div>
  </div>

  <div id="compassOverlay">
    <div class="compass-modal">
      <header class="compass-header">
        <div class="compass-heading">
          <h3 class="compass-title">Bridge Compass</h3>
          <p class="compass-subtitle" id="compassLocationLabel">Awaiting course</p>
        </div>
        <div class="compass-controls">
          <button id="compassSensorBtn" type="button">Enable Sensors</button>
          <button id="closeCompassBtn" type="button" aria-label="Close compass">√ó</button>
        </div>
      </header>
      <div class="compass-body">
        <section class="compass-visual">
          <div class="compass-wrap">
            <div id="compassArrowContainer" class="compass-ring">
              <div class="compass-ring-marks"></div>
              <div class="compass-ring-labels">
                <span class="north">N</span>
                <span class="east">E</span>
                <span class="south">S</span>
                <span class="west">W</span>
              </div>
            </div>
            <div class="compass-inner">
              <div class="compass-needle"></div>
              <div class="compass-cap"></div>
            </div>
          </div>
          <div class="compass-readouts">
            <div class="readout-card">
              <h4>Heading</h4>
              <p><span id="compassHeadingValue">---¬∞</span></p>
            </div>
            <div class="readout-card">
              <h4>Destination</h4>
              <p id="compassDestinationLabel">Set a place</p>
            </div>
            <div class="readout-card">
              <h4>Speed</h4>
              <p><span id="compassSpeedValue">0.0</span><span class="unit">m/s</span></p>
            </div>
            <div class="readout-card">
              <h4>Accuracy</h4>
              <p><span id="compassAccuracyValue">‚Äî</span><span class="unit">m</span></p>
            </div>
          </div>
          <div class="compass-status" id="compassStatus">
            <span class="status-dot"></span>
            <span class="status-text" id="compassStatusText">Waiting for sensors‚Ä¶</span>
          </div>
        </section>
        <section class="compass-directions" id="compassDirectionsCard">
          <div class="directions-header">
            <span>Route Directions</span>
            <button id="toggleDirectionsPanel" type="button" aria-expanded="false">Show directions</button>
          </div>
          <div id="directionsPanel">
            <div id="navigationButtons" class="direction-actions">
              <button id="readDirectionsBtn">üß≠ Read Directions</button>
              <button id="silenceBtn" disabled>üîá Silence</button>
            </div>
            <div class="next-step-card" id="nextStepCard">
              <div class="next-step-label">Next move</div>
              <div id="nextStepText">Waiting for route...</div>
              <div class="next-step-actions">
                <button id="nextStepBtn" type="button" disabled>Next step</button>
                <button id="showAllStepsBtn" type="button">Show full route</button>
              </div>
            </div>
            <div id="directionsList" class="collapsed"></div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script defer src="js/error-handler.js"></script>
  <script defer src="js/cache.js"></script>
  <script defer src="js/state.js"></script>
  <script defer src="js/ui.js"></script>
  <script defer src="js/api.js"></script>
  <script defer src="js/compass.js"></script>
  <script defer src="js/maps.js"></script>
  <script defer src="js/app.js"></script>
</body>
</html>
